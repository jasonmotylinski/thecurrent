<!-- Analytics View (shown when user selects a search result) -->
<div v-if="currentView === 'analytics'" class="analytics-container">
    <div class="row mb-3">
        <div class="col">
            <button class="btn btn-outline-secondary" @click="closeAnalytics">
                &larr; Back to Dashboard
            </button>
        </div>
    </div>
    <div class="row mb-4">
        <div class="col">
            <h2 class="text-center">${ analyticsTitle }</h2>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div v-if="analyticsLoading" class="row mb-4">
        <div class="col-12 text-center">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3">Loading analytics...</p>
        </div>
    </div>

    <!-- Plays Over Time Chart -->
    <div v-if="!analyticsLoading" class="row mb-4">
        <div class="col-12">
            <h4 class="text-center" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Compare how different stations have played this artist/song over time. Each line represents one radio station. Based on monthly aggregates." style="cursor: help;">Plays Over Time by Station</h4>
            <div id="analytics-timeseries"></div>
        </div>
    </div>

    <!-- Top Songs (artist analytics only) -->
    <div class="row mb-4" v-if="analyticsType === 'artist' && analyticsTopSongs.length > 0">
        <div class="col-md-6 offset-md-3">
            <h4 class="text-center" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="The most played songs by this artist across all stations in our database. Click a song to view its detailed analytics." style="cursor: help;">Top 5 Songs</h4>
            <table class="table table-sm">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Total Plays</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="song in analyticsTopSongs" :key="song.title">
                        <td>
                            <a href="#" @click.prevent="loadSongAnalytics(analyticsArtist, song.title)">
                                ${ song.title }
                            </a>
                        </td>
                        <td>${ song.total_plays }</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Top Songs Plays Over Time (artist analytics only) -->
    <div class="row mb-4" v-if="analyticsType === 'artist' && analyticsTopSongs.length > 0">
        <div class="col-12">
            <h4 class="text-center" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Stacked bar chart showing monthly play counts for the top 5 songs. Each color represents a different song. Total bar height shows combined plays for all 5 songs." style="cursor: help;">Top 5 Songs - Plays Over Time</h4>
            <div id="top-songs-timeseries"></div>
        </div>
    </div>
</div>
